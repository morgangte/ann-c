<!DOCTYPE html>
<html lang="en">
    <head>
        <title>ANN in C</title>
        <link rel="stylesheet" href="style/style.css">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Instrument+Sans:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet">
    </head>
    <body>
        <main>
            <section id="main">
                <section class="content-section">
                    <h2>Artificial Neural Network in C</h2>
                    <div class="content-item">
                        <div class="content-column">
                            <p>Artificial Neural Network (ANN) implementation in C. The aim of this project was to familiarize myself with the implementation of a neural network at low level.</p>
                            <a href="https://github.com/morgangte/ann-c" target="_blank" class="link-with-icon">
                                <img src="images/icons/github.svg" width="20em" height="20em">
                                GitHub repository
                            </a>
                        </div>
                    </div>
                </section>
                <section class="content-section">
                    <h2>Implementation</h2>
                    <div class="content-item">
                        <div class="content-column">
                            <p>The implementation is such that the architecture can be easily adjusted: number and size of layers, activation function. Create a Neural Network with 2 layers (and the input layer):</p>
<pre class="code-block">
<span class="code-type">NeuralNetwork</span> network = neuralnetwork_create(<span class="code-value">2</span>);
neuralnetwork_add_layer(&amp;network, <span class="code-macro">INPUT_SIZE</span>, <span class="code-macro">SIGMOID_ACTIVATION</span>, <span class="code-macro">HIDDEN_SIZE</span>);
neuralnetwork_add_layer(&amp;network, <span class="code-macro">HIDDEN_SIZE</span>, <span class="code-macro">SOFTMAX_ACTIVATION</span>, <span class="code-macro">OUTPUT_SIZE</span>);

neuralnetwork_initialize(&amp;network);
</pre>
                            <p>Initialization will set weights and biases of each layer to random values. Set training parameters, then train the Neural Network:</p>
<pre class="code-block">
<span class="code-type">TrainingContext</span> context = {
    .learning_rate = <span class="code-value">0.10</span>,
    .number_of_epochs = <span class="code-value">5</span>,
    .number_of_examples = number_of_images,
};
neuralnetwork_train(&amp;network, images, labels, &amp;context);
</pre>
                            <p>Evaluate the Neural Network accuracy, or simply ask the Neural Network from an input:</p>
<pre class="code-block">
<span style="color: rgb(255, 123, 114); font-weight: 400;">double</span> accuracy = neuralnetwork_benchmark(&amp;network, test_images, test_labels, test_images_count);

<span style="color: rgb(255, 123, 114); font-weight: 400;">uint8_t</span> answer = neuralnetwork_ask(network, input);
</pre>
                            <p>You can easily save (usually after training) and load a Neural Network to/from a file:</p>
<pre class="code-block">
neuralnetwork_save(&amp;network, &amp;context, <span style="color: rgb(165, 214, 255); font-weight: 400;">"model.bin"</span>);

<span class="code-comment">// From a new file</span>
<span class="code-type">NeuralNetwork</span> network;
<span class="code-type">TrainingContext</span> context;
neuralnetwork_load(&amp;network, &amp;context, <span style="color: rgb(165, 214, 255); font-weight: 400;">"model.bin"</span>);
</pre>
                            <p>Finally, free the Neural Network:</p>
<pre class="code-block">
neuralnetwork_destroy(&amp;network);
</pre>
                            <p>To speed up training, I also used the <a href="https://www.openmp.org/" target="_blank">OpenMP API</a>.</p>
                        </div>
                    </div>
                </section>
                <section class="content-section">
                    <h2>Example: MNIST Dataset</h2>
                    <div class="content-item">
                        <div class="content-column">
                            <p>This famous dataset is a set of hand-written digits (between 0 and 9) black and white images of 28 × 28 pixels. The label of each example corresponds to the digit of the image.</p>
                            <div class="images-list">
                                <div class="images-list-item">
                                    <img src="images/mnist/digit_0.png">
                                    <p>0</p>
                                </div>
                                <div class="images-list-item">
                                    <img src="images/mnist/digit_1.png">
                                    <p>1</p>
                                </div>
                                <div class="images-list-item">
                                    <img src="images/mnist/digit_2.png">
                                    <p>2</p>
                                </div>
                                <div class="images-list-item">
                                    <img src="images/mnist/digit_3.png">
                                    <p>3</p>
                                </div>
                                <div class="images-list-item">
                                    <img src="images/mnist/digit_4.png">
                                    <p>4</p>
                                </div>
                                <div class="images-list-item">
                                    <img src="images/mnist/digit_5.png">
                                    <p>5</p>
                                </div>
                                <div class="images-list-item">
                                    <img src="images/mnist/digit_6.png">
                                    <p>6</p>
                                </div>
                                <div class="images-list-item">
                                    <img src="images/mnist/digit_7.png">
                                    <p>7</p>
                                </div>
                                <div class="images-list-item">
                                    <img src="images/mnist/digit_8.png">
                                    <p>8</p>
                                </div>
                                <div class="images-list-item">
                                    <img src="images/mnist/digit_9.png">
                                    <p>9</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="content-item">
                        <div class="content-column">
                            <h3>Architecture</h3>
                            <p>The ANN used for this dataset is made up of 3 layers:</p>
                            <ul>
                                <li>Input layer: 784 neurons (28 × 28)</li>
                                <li>Hidden layer: 89 neurons</li>
                                <li>Output layer: 10 neurons (one for each class)</li>
                            </ul>
                            <p>We use the sigmoid activation function on the hidden layer, and the softmax activation function on the output layer to convert the output vector into a probability distribution.</p>
                        </div>
                    </div>
                    <div class="content-item">
                        <div class="content-column">
                            <h3>Training</h3>
                            <ul>
                                <li>5 epochs</li>
                                <li>Learning rate of 0.10</li>
                                <li>60,000 images as training examples</li>
                            </ul>
                        </div>
                    </div>
                    <div class="content-item">
                        <div class="content-column">
                            <h3>Results</h3>
                            <p>After testing on 10,000 examples (distinct from training examples), we obtain a classification accuracy of 96.4%.</p>
                            <ul>
                                <li>
                                    <p>Classification accuracy across 5 epochs:</p>
                                </li>
                            </ul>
                            <div class="images-list">
                                <div class="images-list-item">
                                    <img src="images/mnist/mnist_accuracy.svg">
                                </div>
                            </div>
                            <ul>
                                <li>
                                    <p>Loss across 5 epochs:</p>
                                </li>
                            </ul>
                            <div class="images-list">
                                <div class="images-list-item">
                                    <img src="images/mnist/mnist_loss.svg">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="content-item">
                        <div class="content-column">
                            <p>Read more about the MNIST Dataset at <a href="https://keras.io/api/datasets/mnist/" target="_blank">https://keras.io/api/datasets/mnist/</a></p>
                        </div>
                    </div>
                </section>
            </section>
        </main>
    </body>
</html>